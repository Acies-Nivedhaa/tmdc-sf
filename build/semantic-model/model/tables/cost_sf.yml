tables:
  - name: cost_sf
    sql: {{ load_sql('cost_sf') }}
    description: Captures details of users and their activity on the website
    public: true 

    joins:
      - name: revenue_sf
        relationship: one_to_one
        sql: "{TABLE.cost_id} = {revenue_sf.revenue_id}"

    dimensions:
      - name: cost_id
        type: number
        column: cost_id
        description: "ID"
        primary_key: true

      - name: channel
        type: string
        column: channel
        description: "Channel through which the customer got into the website"

      - name: cost
        type: number
        column: cost
        description: "Cost associated with the visit"

      - name: calc_revenue
        column: "{revenue_sf.revenue}"
        type: number
        description: Revenue
        public: false
 

    measures:
      - name: profit
        sql: SUM({TABLE.calc_revenue}-{TABLE.cost})
        type: number 
        description: Profit earned


